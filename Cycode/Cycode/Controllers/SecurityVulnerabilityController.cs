using Microsoft.AspNetCore.Mvc;
using GraphQL;
using GraphQL.Client.Http;
using GraphQL.Client.Serializer.Newtonsoft;
using Cycode.DataContracts;
using Cycode.BusinessServices;
using FromServices = Microsoft.AspNetCore.Mvc.FromServicesAttribute;
using Cycode.DataAccess;

namespace Cycode.Controllers;

[ApiController]
[ApiVersion("1")]
[Route("api/v{version:apiVersion}")]
public class SecurityVulnerabilityController : ControllerBase
{
    private readonly ISecurityVulnerabilityService _securityVulnerabilityService;
    private readonly ILogger<SecurityVulnerabilityController> _logger;

    public SecurityVulnerabilityController(
        [FromServices] ISecurityVulnerabilityService securityVulnerabilityService,
        ILogger<SecurityVulnerabilityController> logger)
    {
        _securityVulnerabilityService = securityVulnerabilityService;
        _logger = logger;
    }

    [HttpPost]
    [Route("scan")]
    public async Task<ScanResponse> Scan([FromBody] ScanRequest scanRequest)
    {
        return await _securityVulnerabilityService.Scan(scanRequest);
    }

}